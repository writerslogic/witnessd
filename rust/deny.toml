[graph]
targets = [
    "x86_64-apple-darwin",
    "aarch64-apple-darwin",
    "x86_64-pc-windows-msvc",
    "x86_64-unknown-linux-gnu",
]

[advisories]
version = 2
ignore = [
    # RSA Marvin Attack - no fix available, low risk for our use case
    "RUSTSEC-2023-0071",
    # rustls-pemfile unmaintained - transitive dep from reqwest, no fix available
    "RUSTSEC-2025-0134",
    # bincode unmaintained - works fine, will migrate eventually
    "RUSTSEC-2025-0141",
]

[licenses]
version = 2
allow = [
    "MIT",
    "Apache-2.0",
    "Apache-2.0 WITH LLVM-exception",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "ISC",
    "CC0-1.0",
    "OpenSSL",
    "Unicode-DFS-2016",
    "Unicode-3.0",
    "Zlib",
    "MPL-2.0",
]
confidence-threshold = 0.8

# Our own crates use PolyForm Noncommercial license (custom, non-SPDX)
[[licenses.exceptions]]
name = "witnessd-core"
allow = ["PolyForm-Noncommercial-1.0.0"]

[[licenses.exceptions]]
name = "witnessd-cli"
allow = ["PolyForm-Noncommercial-1.0.0"]

# allo-isolate doesn't specify a license in Cargo.toml but is MIT licensed
[[licenses.clarify]]
name = "allo-isolate"
expression = "MIT"
license-files = []

[bans]
multiple-versions = "warn"
wildcards = "deny"
highlight = "all"
